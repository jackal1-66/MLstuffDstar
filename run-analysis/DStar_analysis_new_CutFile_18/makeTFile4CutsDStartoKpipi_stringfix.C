// gSystem->SetIncludePath("-I. -I$ROOTSYS/include -I$ALICE_ROOT -I$ALICE_ROOT/include -I$ALICE_ROOT/ITS -I$ALICE_ROOT/TPC -I$ALICE_ROOT/CONTAINERS -I$ALICE_ROOT/STEER -I$ALICE_ROOT/TRD -I$ALICE_ROOT/macros -I$ALICE_ROOT/ANALYSIS -I$ALICE_ROOT/PWG3 -I$ALICE_ROOT/PWG3/vertexingHF -g");

#include <Riostream.h>
#include <TFile.h>
#include "AliRDHFCutsDStartoKpipi.h"
#include <TClonesArray.h>
#include <TParameter.h>


//Use:
//Set hard coded commentet with //set this!!
// root[] .L makeTFile4CutsDStar.....C++
// root[] makeInputAliAnalysisTaskSED0Mass()
// root[] makeInputAliAnalysisTaskSESignificanceMaximization()
//similar macros for the other D mesons

//Author: Alessandro Grelli, a.grelli@uu.nl


//macro to make a .root file which contains an AliRDHFCutsDStartoKpipi for AliAnalysisTaskSEDStarSpectra task and CF task
void makeInputAliAnalysisTaskSEDStarSpectra(const char *set_cuts="bologna"){

  AliRDHFCutsDStartoKpipi* RDHFDStartoKpipi=new AliRDHFCutsDStartoKpipi();
  RDHFDStartoKpipi->SetName("DStartoKpipiCuts");
  RDHFDStartoKpipi->SetTitle("Cuts for D* analysis");

  //Centrality selection
  RDHFDStartoKpipi->SetUseCentrality(kFALSE);
  RDHFDStartoKpipi->SetMinCentrality(0);
  RDHFDStartoKpipi->SetMaxCentrality(100);

  AliESDtrackCuts* esdTrackCuts=new AliESDtrackCuts();
  esdTrackCuts->SetRequireSigmaToVertex(kFALSE);
  //default
  esdTrackCuts->SetRequireTPCRefit(kTRUE);
  esdTrackCuts->SetRequireITSRefit(kTRUE);
  //esdTrackCuts->SetMinNClustersTPC(70);
  esdTrackCuts->SetMinNClustersTPC(70);
  esdTrackCuts->SetMinNClustersITS(2);
  esdTrackCuts->SetClusterRequirementITS(AliESDtrackCuts::kSPD,
					 AliESDtrackCuts::kAny); 
 // default is kBoth, otherwise kAny
  esdTrackCuts->SetMinDCAToVertexXY(0.);
  esdTrackCuts->SetPtRange(0.3,1.e10);

 // soft pion pre-selections 
  AliESDtrackCuts* esdSoftPicuts=new AliESDtrackCuts();
  esdSoftPicuts->SetRequireSigmaToVertex(kFALSE);
  //default
  esdSoftPicuts->SetRequireTPCRefit(kFALSE);
  esdSoftPicuts->SetRequireITSRefit(kTRUE);
  esdSoftPicuts->SetClusterRequirementITS(AliESDtrackCuts::kSPD,
					  AliESDtrackCuts::kAny); //test d0 asimmetry
  esdSoftPicuts->SetPtRange(0.0,1.e10);


  // set pre selections
  RDHFDStartoKpipi->AddTrackCuts(esdTrackCuts);
  RDHFDStartoKpipi->AddTrackCutsSoftPi(esdSoftPicuts);

  const Int_t nvars=16;
  const Int_t nptbins=25;
  
  Float_t* ptbins;
  ptbins=new Float_t[nptbins+1];
  ptbins[0]=0.;
  ptbins[1]=0.5;
  ptbins[2]=1.;
  ptbins[3]=1.5;
  ptbins[4]=2.;
  ptbins[5]=2.5;
  ptbins[6]=3.;
  ptbins[7]=3.5;
  ptbins[8]=4.;
  ptbins[9]=4.5;
  ptbins[10]=5.;
  ptbins[11]=5.5; 
  ptbins[12]=6.;
  ptbins[13]=6.5;
  ptbins[14]=7.;
  ptbins[15]=7.5;
  ptbins[16]=8.;
  ptbins[17]=9.;
  ptbins[18]=10.;
  ptbins[19]=11.;
  ptbins[20]=12.;
  ptbins[21]=14.;
  ptbins[22]=16.;
  ptbins[23]=24.;
  ptbins[24]=36.;
  ptbins[25]=50.;

  RDHFDStartoKpipi->SetPtBins(nptbins+1,ptbins);
  
  Float_t** rdcutsvalmine;
  rdcutsvalmine=new Float_t*[nvars];
  for(Int_t iv=0;iv<nvars;iv++){
    rdcutsvalmine[iv]=new Float_t[nptbins];
  }
  
  if(std::strncmp(set_cuts,"bologna",20) == 0){
    //0-0.5
    rdcutsvalmine[0][0]=0.03;
    rdcutsvalmine[1][0]=0.0315;
    rdcutsvalmine[2][0]=0.8;
    rdcutsvalmine[3][0]=0.5;
    rdcutsvalmine[4][0]=0.5;
    rdcutsvalmine[5][0]=0.1;
    rdcutsvalmine[6][0]=0.1;
    rdcutsvalmine[7][0]=-0.00033;
    rdcutsvalmine[8][0]=0.865;
    rdcutsvalmine[9][0]=0.3;
    rdcutsvalmine[10][0]=0.15;
    rdcutsvalmine[11][0]=0.05;
    rdcutsvalmine[12][0]=0.5;
    rdcutsvalmine[13][0]=1;
    rdcutsvalmine[14][0]=0;
    rdcutsvalmine[15][0]=4.;
    //0.5-1
    rdcutsvalmine[0][1]=0.03;
    rdcutsvalmine[1][1]=0.0315;
    rdcutsvalmine[2][1]=0.8;
    rdcutsvalmine[3][1]=0.5;
    rdcutsvalmine[4][1]=0.5;
    rdcutsvalmine[5][1]=0.1;
    rdcutsvalmine[6][1]=0.1;
    rdcutsvalmine[7][1]=-0.00033;
    rdcutsvalmine[8][1]=0.865;
    rdcutsvalmine[9][1]=0.3;
    rdcutsvalmine[10][1]=0.15;
    rdcutsvalmine[11][1]=0.05;
    rdcutsvalmine[12][1]=0.5;
    rdcutsvalmine[13][1]=1;
    rdcutsvalmine[14][1]=0;
    rdcutsvalmine[15][1]=4.;
    //1-1.5
    rdcutsvalmine[0][2]=0.03;
    rdcutsvalmine[1][2]=0.0315;
    rdcutsvalmine[2][2]=0.8;
    rdcutsvalmine[3][2]=0.5;
    rdcutsvalmine[4][2]=0.5;
    rdcutsvalmine[5][2]=0.1;
    rdcutsvalmine[6][2]=0.1;
    rdcutsvalmine[7][2]=-0.00033;
    rdcutsvalmine[8][2]=0.865;
    rdcutsvalmine[9][2]=0.3;
    rdcutsvalmine[10][2]=0.15;
    rdcutsvalmine[11][2]=0.05;
    rdcutsvalmine[12][2]=0.5;
    rdcutsvalmine[13][2]=1;
    rdcutsvalmine[14][2]=0;
    rdcutsvalmine[15][2]=4.;
    //1.5-2
    rdcutsvalmine[0][3]=0.03;
    rdcutsvalmine[1][3]=0.0315;
    rdcutsvalmine[2][3]=0.8;
    rdcutsvalmine[3][3]=0.5;
    rdcutsvalmine[4][3]=0.5;
    rdcutsvalmine[5][3]=0.1;
    rdcutsvalmine[6][3]=0.1;
    rdcutsvalmine[7][3]=-0.00033;
    rdcutsvalmine[8][3]=0.865;
    rdcutsvalmine[9][3]=0.3;
    rdcutsvalmine[10][3]=0.15;
    rdcutsvalmine[11][3]=0.05;
    rdcutsvalmine[12][3]=0.5;
    rdcutsvalmine[13][3]=1.;
    rdcutsvalmine[14][3]=0.;
    rdcutsvalmine[15][3]=4.;
    //2-2.5
    rdcutsvalmine[0][4]=0.032;
    rdcutsvalmine[1][4]=0.027;
    rdcutsvalmine[2][4]=0.8;
    rdcutsvalmine[3][4]=1.;
    rdcutsvalmine[4][4]=1.;
    rdcutsvalmine[5][4]=0.1;
    rdcutsvalmine[6][4]=0.1;
    rdcutsvalmine[7][4]=-0.00010;
    rdcutsvalmine[8][4]=0.9;
    rdcutsvalmine[9][4]=0.3;
    rdcutsvalmine[10][4]=0.15;
    rdcutsvalmine[11][4]=0.05;
    rdcutsvalmine[12][4]=0.5;
    rdcutsvalmine[13][4]=1.;
    rdcutsvalmine[14][4]=0.;
    rdcutsvalmine[15][4]=4.;
    //2.5-3
    rdcutsvalmine[0][5]=0.032;
    rdcutsvalmine[1][5]=0.027;
    rdcutsvalmine[2][5]=0.8;
    rdcutsvalmine[3][5]=1.;
    rdcutsvalmine[4][5]=1.;
    rdcutsvalmine[5][5]=0.1;
    rdcutsvalmine[6][5]=0.1;
    rdcutsvalmine[7][5]=-0.00010;
    rdcutsvalmine[8][5]=0.9;
    rdcutsvalmine[9][5]=0.3;
    rdcutsvalmine[10][5]=0.15;
    rdcutsvalmine[11][5]=0.05;
    rdcutsvalmine[12][5]=0.5;
    rdcutsvalmine[13][5]=1.;
    rdcutsvalmine[14][5]=0.;
    rdcutsvalmine[15][5]=4.;
    //3-3.5
    rdcutsvalmine[0][6]=0.032;
    rdcutsvalmine[1][6]=0.03375;
    rdcutsvalmine[2][6]=0.8;
    rdcutsvalmine[3][6]=1.;
    rdcutsvalmine[4][6]=1.;
    rdcutsvalmine[5][6]=0.1;
    rdcutsvalmine[6][6]=0.1;
    rdcutsvalmine[7][6]=-0.00010;
    rdcutsvalmine[8][6]=0.83;
    rdcutsvalmine[9][6]=0.3;
    rdcutsvalmine[10][6]=0.15;
    rdcutsvalmine[11][6]=0.05;
    rdcutsvalmine[12][6]=0.5;
    rdcutsvalmine[13][6]=1;
    rdcutsvalmine[14][6]=0.;
    rdcutsvalmine[15][6]=0.;
    //3.5-4
    rdcutsvalmine[0][7]=0.032;
    rdcutsvalmine[1][7]=0.03375;
    rdcutsvalmine[2][7]=0.8;
    rdcutsvalmine[3][7]=1.;
    rdcutsvalmine[4][7]=1.;
    rdcutsvalmine[5][7]=0.1;
    rdcutsvalmine[6][7]=0.1;
    rdcutsvalmine[7][7]=-0.00010;
    rdcutsvalmine[8][7]=0.83;
    rdcutsvalmine[9][7]=0.3;
    rdcutsvalmine[10][7]=0.15;
    rdcutsvalmine[11][7]=0.05;
    rdcutsvalmine[12][7]=0.5;
    rdcutsvalmine[13][7]=1;
    rdcutsvalmine[14][7]=0.;
    rdcutsvalmine[15][7]=0.;
    //4-4.5
    rdcutsvalmine[0][8]=0.032;
    rdcutsvalmine[1][8]=0.042;
    rdcutsvalmine[2][8]=0.9;
    rdcutsvalmine[3][8]=1.;
    rdcutsvalmine[4][8]=1.;
    rdcutsvalmine[5][8]=0.1;
    rdcutsvalmine[6][8]=0.1;
    rdcutsvalmine[7][8]=-0.000028;
    rdcutsvalmine[8][8]=0.81;
    rdcutsvalmine[9][8]=0.3;
    rdcutsvalmine[10][8]=0.1;
    rdcutsvalmine[11][8]=0.05;
    rdcutsvalmine[12][8]=100.;
    rdcutsvalmine[13][8]=1.;
    rdcutsvalmine[14][8]=0.;
    rdcutsvalmine[15][8]=0.;
    //4.5-5
    rdcutsvalmine[0][9]=0.032;
    rdcutsvalmine[1][9]=0.042;
    rdcutsvalmine[2][9]=0.9;
    rdcutsvalmine[3][9]=1.;
    rdcutsvalmine[4][9]=1.;
    rdcutsvalmine[5][9]=0.1;
    rdcutsvalmine[6][9]=0.1;
    rdcutsvalmine[7][9]=-0.000028;
    rdcutsvalmine[8][9]=0.81;
    rdcutsvalmine[9][9]=0.3;
    rdcutsvalmine[10][9]=0.1;
    rdcutsvalmine[11][9]=0.05;
    rdcutsvalmine[12][9]=100.;
    rdcutsvalmine[13][9]=1.;
    rdcutsvalmine[14][9]=0.;
    rdcutsvalmine[15][9]=0.;
    //5-5.5
    rdcutsvalmine[0][10]=0.036;
    rdcutsvalmine[1][10]=0.05;
    rdcutsvalmine[2][10]=1.0;
    rdcutsvalmine[3][10]=1.0;
    rdcutsvalmine[4][10]=1.0;
    rdcutsvalmine[5][10]=0.09;
    rdcutsvalmine[6][10]=0.09;
    rdcutsvalmine[7][10]=0.000055;
    rdcutsvalmine[8][10]=0.79;
    rdcutsvalmine[9][10]=0.3;
    rdcutsvalmine[10][10]=0.1;
    rdcutsvalmine[11][10]=0.05;
    rdcutsvalmine[12][10]=100.;
    rdcutsvalmine[13][10]=1.;
    rdcutsvalmine[14][10]=0.;
    rdcutsvalmine[15][10]=0.;
    //5.5-6
    rdcutsvalmine[0][11]=0.036;
    rdcutsvalmine[1][11]=0.05;
    rdcutsvalmine[2][11]=1.0;
    rdcutsvalmine[3][11]=1.0;
    rdcutsvalmine[4][11]=1.0;
    rdcutsvalmine[5][11]=0.09;
    rdcutsvalmine[6][11]=0.09;
    rdcutsvalmine[7][11]=0.000055;
    rdcutsvalmine[8][11]=0.79;
    rdcutsvalmine[9][11]=0.3;
    rdcutsvalmine[10][11]=0.1;
    rdcutsvalmine[11][11]=0.05;
    rdcutsvalmine[12][11]=100.;
    rdcutsvalmine[13][11]=1.;
    rdcutsvalmine[14][11]=0.;
    rdcutsvalmine[15][11]=0.;
    //6-6.5
    rdcutsvalmine[0][12]=0.036;
    rdcutsvalmine[1][12]=0.1;
    rdcutsvalmine[2][12]=1.0;
    rdcutsvalmine[3][12]=1.0;
    rdcutsvalmine[4][12]=1.0;
    rdcutsvalmine[5][12]=0.1;
    rdcutsvalmine[6][12]=0.1;
    rdcutsvalmine[7][12]=0.001;
    rdcutsvalmine[8][12]=0.7;
    rdcutsvalmine[9][12]=0.3;
    rdcutsvalmine[10][12]=0.1;
    rdcutsvalmine[11][12]=0.05;
    rdcutsvalmine[12][12]=100.;
    rdcutsvalmine[13][12]=1;
    rdcutsvalmine[14][12]=0.;
    rdcutsvalmine[15][12]=0.;
    //6.5-7
    rdcutsvalmine[0][13]=0.036;
    rdcutsvalmine[1][13]=0.1;
    rdcutsvalmine[2][13]=1.0;
    rdcutsvalmine[3][13]=1.0;
    rdcutsvalmine[4][13]=1.0;
    rdcutsvalmine[5][13]=0.1;
    rdcutsvalmine[6][13]=0.1;
    rdcutsvalmine[7][13]=0.001;
    rdcutsvalmine[8][13]=0.7;
    rdcutsvalmine[9][13]=0.3;
    rdcutsvalmine[10][13]=0.1;
    rdcutsvalmine[11][13]=0.05;
    rdcutsvalmine[12][13]=100.;
    rdcutsvalmine[13][13]=1;
    rdcutsvalmine[14][13]=0.;
    rdcutsvalmine[15][13]=0.;
    //7-7.5
    rdcutsvalmine[0][14]=0.036;
    rdcutsvalmine[1][14]=0.1;
    rdcutsvalmine[2][14]=1.0;
    rdcutsvalmine[3][14]=1.0;
    rdcutsvalmine[4][14]=1.0;
    rdcutsvalmine[5][14]=0.1;
    rdcutsvalmine[6][14]=0.1;
    rdcutsvalmine[7][14]=0.00025;
    rdcutsvalmine[8][14]=0.8;
    rdcutsvalmine[9][14]=0.3;
    rdcutsvalmine[10][14]=0.1;
    rdcutsvalmine[11][14]=0.05;
    rdcutsvalmine[12][14]=100.;
    rdcutsvalmine[13][14]=1;
    rdcutsvalmine[14][14]=0.;
    rdcutsvalmine[15][14]=0.;
    //7.5-8
    rdcutsvalmine[0][15]=0.036;
    rdcutsvalmine[1][15]=0.1;
    rdcutsvalmine[2][15]=1.0;
    rdcutsvalmine[3][15]=1.0;
    rdcutsvalmine[4][15]=1.0;
    rdcutsvalmine[5][15]=0.1;
    rdcutsvalmine[6][15]=0.1;
    rdcutsvalmine[7][15]=0.00025;
    rdcutsvalmine[8][15]=0.8;
    rdcutsvalmine[9][15]=0.3;
    rdcutsvalmine[10][15]=0.1;
    rdcutsvalmine[11][15]=0.05;
    rdcutsvalmine[12][15]=100.;
    rdcutsvalmine[13][15]=1;
    rdcutsvalmine[14][15]=0.;
    rdcutsvalmine[15][15]=0.;
    //8-9
    rdcutsvalmine[0][16]=0.05;
    rdcutsvalmine[1][16]=0.105;
    rdcutsvalmine[2][16]=1.0;
    rdcutsvalmine[3][16]=1.0;
    rdcutsvalmine[4][16]=1.0;
    rdcutsvalmine[5][16]=0.1;
    rdcutsvalmine[6][16]=0.1;
    rdcutsvalmine[7][16]=0.01;
    rdcutsvalmine[8][16]=0.68;
    rdcutsvalmine[9][16]=0.3;
    rdcutsvalmine[10][16]=0.1;
    rdcutsvalmine[11][16]=0.05;
    rdcutsvalmine[12][16]=100.;
    rdcutsvalmine[13][16]=1;
    rdcutsvalmine[14][16]=0.;
    rdcutsvalmine[15][16]=0.;
    //9-10
    rdcutsvalmine[0][17]=0.05;
    rdcutsvalmine[1][17]=0.105;
    rdcutsvalmine[2][17]=1.0;
    rdcutsvalmine[3][17]=1.0;
    rdcutsvalmine[4][17]=1.0;
    rdcutsvalmine[5][17]=0.1;
    rdcutsvalmine[6][17]=0.1;
    rdcutsvalmine[7][17]=0.01;
    rdcutsvalmine[8][17]=0.68;
    rdcutsvalmine[9][17]=0.3;
    rdcutsvalmine[10][17]=0.1;
    rdcutsvalmine[11][17]=0.05;
    rdcutsvalmine[12][17]=100.;
    rdcutsvalmine[13][17]=1;
    rdcutsvalmine[14][17]=0.;
    rdcutsvalmine[15][17]=0.;
    //10-11
    rdcutsvalmine[0][18]=0.05;
    rdcutsvalmine[1][18]=0.105;
    rdcutsvalmine[2][18]=1.0;
    rdcutsvalmine[3][18]=1.0;
    rdcutsvalmine[4][18]=1.0;
    rdcutsvalmine[5][18]=0.1;
    rdcutsvalmine[6][18]=0.1;
    rdcutsvalmine[7][18]=0.01;
    rdcutsvalmine[8][18]=0.68;
    rdcutsvalmine[9][18]=0.3;
    rdcutsvalmine[10][18]=0.1;
    rdcutsvalmine[11][18]=0.05;
    rdcutsvalmine[12][18]=100.;
    rdcutsvalmine[13][18]=1;
    rdcutsvalmine[14][18]=0.;
    rdcutsvalmine[15][18]=0.;
    //11-12
    rdcutsvalmine[0][19]=0.05;
    rdcutsvalmine[1][19]=0.105;
    rdcutsvalmine[2][19]=1.0;
    rdcutsvalmine[3][19]=1.0;
    rdcutsvalmine[4][19]=1.0;
    rdcutsvalmine[5][19]=0.1;
    rdcutsvalmine[6][19]=0.1;
    rdcutsvalmine[7][19]=0.01;
    rdcutsvalmine[8][19]=0.68;
    rdcutsvalmine[9][19]=0.3;
    rdcutsvalmine[10][19]=0.1;
    rdcutsvalmine[11][19]=0.05;
    rdcutsvalmine[12][19]=100.;
    rdcutsvalmine[13][19]=1;
    rdcutsvalmine[14][19]=0.;
    rdcutsvalmine[15][19]=0.;
    //12-14
    rdcutsvalmine[0][20]=0.094;
    rdcutsvalmine[1][20]=0.1;
    rdcutsvalmine[2][20]=1.0;
    rdcutsvalmine[3][20]=0.3;
    rdcutsvalmine[4][20]=0.3;
    rdcutsvalmine[5][20]=0.2;
    rdcutsvalmine[6][20]=0.2;
    rdcutsvalmine[7][20]=0.01;
    rdcutsvalmine[8][20]=0.6;
    rdcutsvalmine[9][20]=0.3;
    rdcutsvalmine[10][20]=0.15;
    rdcutsvalmine[11][20]=0.45;
    rdcutsvalmine[12][20]=100.;
    rdcutsvalmine[13][20]=1;
    rdcutsvalmine[14][20]=0.;
    rdcutsvalmine[15][20]=0.;
    //14-16
    rdcutsvalmine[0][21]=0.094;
    rdcutsvalmine[1][21]=0.1;
    rdcutsvalmine[2][21]=1.0;
    rdcutsvalmine[3][21]=0.3;
    rdcutsvalmine[4][21]=0.3;
    rdcutsvalmine[5][21]=0.2;
    rdcutsvalmine[6][21]=0.2;
    rdcutsvalmine[7][21]=0.01;
    rdcutsvalmine[8][21]=0.6;
    rdcutsvalmine[9][21]=0.3;
    rdcutsvalmine[10][21]=0.15;
    rdcutsvalmine[11][21]=0.45;
    rdcutsvalmine[12][21]=100.;
    rdcutsvalmine[13][21]=1;
    rdcutsvalmine[14][21]=0.;
    rdcutsvalmine[15][21]=0.;
    //16-24
    rdcutsvalmine[0][22]=0.7;
    rdcutsvalmine[1][22]=0.15;
    rdcutsvalmine[2][22]=1.0;
    rdcutsvalmine[3][22]=0.3;
    rdcutsvalmine[4][22]=0.3;
    rdcutsvalmine[5][22]=0.5;
    rdcutsvalmine[6][22]=0.5;
    rdcutsvalmine[7][22]=0.01;
    rdcutsvalmine[8][22]=0.6;
    rdcutsvalmine[9][22]=0.3;
    rdcutsvalmine[10][22]=0.3;
    rdcutsvalmine[11][22]=0.05;
    rdcutsvalmine[12][22]=100.;
    rdcutsvalmine[13][22]=1;
    rdcutsvalmine[14][22]=0.;
    rdcutsvalmine[15][22]=0.;
    //24-36
    rdcutsvalmine[0][23]=0.7;
    rdcutsvalmine[1][23]=0.125;
    rdcutsvalmine[2][23]=1.0;
    rdcutsvalmine[3][23]=0.3;
    rdcutsvalmine[4][23]=0.3;
    rdcutsvalmine[5][23]=0.5;
    rdcutsvalmine[6][23]=0.5;
    rdcutsvalmine[7][23]=0.01;
    rdcutsvalmine[8][23]=0.6;
    rdcutsvalmine[9][23]=0.3;
    rdcutsvalmine[10][23]=0.1;
    rdcutsvalmine[11][23]=0.05;
    rdcutsvalmine[12][23]=10000.;
    rdcutsvalmine[13][23]=0.5;
    rdcutsvalmine[14][23]=-1;
    rdcutsvalmine[15][23]=0.;
    //36-50
    rdcutsvalmine[0][24]=0.7;
    rdcutsvalmine[1][24]=0.125;
    rdcutsvalmine[2][24]=1.0;
    rdcutsvalmine[3][24]=0.3;
    rdcutsvalmine[4][24]=0.3;
    rdcutsvalmine[5][24]=0.5;
    rdcutsvalmine[6][24]=0.5;
    rdcutsvalmine[7][24]=0.01;
    rdcutsvalmine[8][24]=0.6;
    rdcutsvalmine[9][24]=0.3;
    rdcutsvalmine[10][24]=0.1;
    rdcutsvalmine[11][24]=0.05;
    rdcutsvalmine[12][24]=10000.;
    rdcutsvalmine[13][24]=0.5;
    rdcutsvalmine[14][24]=-1;
    rdcutsvalmine[15][24]=0.;
  }
  else if(std::strncmp(set_cuts,"utrecht",20) == 0){
    //0-0.5
    rdcutsvalmine[0][0]=0.7;
    rdcutsvalmine[1][0]=0.03;
    rdcutsvalmine[2][0]=0.8;
    rdcutsvalmine[3][0]=0.3;
    rdcutsvalmine[4][0]=0.3;
    rdcutsvalmine[5][0]=0.1;
    rdcutsvalmine[6][0]=0.1;
    rdcutsvalmine[7][0]=0.00035;
    rdcutsvalmine[8][0]=0.73;
    rdcutsvalmine[9][0]=0.3;
    rdcutsvalmine[10][0]=0.1;
    rdcutsvalmine[11][0]=0.05;
    rdcutsvalmine[12][0]=100.;
    rdcutsvalmine[13][0]=0.5;
    rdcutsvalmine[14][0]=-1.;
    rdcutsvalmine[15][0]=0.;
    //0.5-1
    rdcutsvalmine[0][1]=0.7;
    rdcutsvalmine[1][1]=0.03;
    rdcutsvalmine[2][1]=0.8;
    rdcutsvalmine[3][1]=0.3;
    rdcutsvalmine[4][1]=0.3;
    rdcutsvalmine[5][1]=0.1;
    rdcutsvalmine[6][1]=0.1;
    rdcutsvalmine[7][1]=-0.00020;
    rdcutsvalmine[8][1]=0.73;
    rdcutsvalmine[9][1]=0.3;
    rdcutsvalmine[10][1]=0.1;
    rdcutsvalmine[11][1]=0.05;
    rdcutsvalmine[12][1]=100.;
    rdcutsvalmine[13][1]=0.5;
    rdcutsvalmine[14][1]=-1.;
    rdcutsvalmine[15][1]=0.;
    //1-2
    rdcutsvalmine[0][2]=0.7;
    rdcutsvalmine[1][2]=0.02;
    rdcutsvalmine[2][2]=0.8;
    rdcutsvalmine[3][2]=0.4;
    rdcutsvalmine[4][2]=0.4;
    rdcutsvalmine[5][2]=0.1;
    rdcutsvalmine[6][2]=0.1;
    rdcutsvalmine[7][2]=-0.00036;
    rdcutsvalmine[8][2]=0.82;
    rdcutsvalmine[9][2]=0.3;
    rdcutsvalmine[10][2]=0.1;
    rdcutsvalmine[11][2]=0.05;
    rdcutsvalmine[12][2]=100.;
    rdcutsvalmine[13][2]=0.5;
    rdcutsvalmine[14][2]=-1.;
    rdcutsvalmine[15][2]=0.;
    //2-3
    rdcutsvalmine[0][3]=0.7;
    rdcutsvalmine[1][3]=0.02;
    rdcutsvalmine[2][3]=0.8;
    rdcutsvalmine[3][3]=0.7;
    rdcutsvalmine[4][3]=0.7;
    rdcutsvalmine[5][3]=0.08;
    rdcutsvalmine[6][3]=0.08;
    rdcutsvalmine[7][3]=-0.00016;
    rdcutsvalmine[8][3]=0.90;
    rdcutsvalmine[9][3]=0.3;
    rdcutsvalmine[10][3]=0.1;
    rdcutsvalmine[11][3]=0.05;
    rdcutsvalmine[12][3]=100.;
    rdcutsvalmine[13][3]=0.5;
    rdcutsvalmine[14][3]=-1.;
    rdcutsvalmine[15][3]=0.;
    //3-4
    rdcutsvalmine[0][4]=0.7;
    rdcutsvalmine[1][4]=0.05;
    rdcutsvalmine[2][4]=0.8;
    rdcutsvalmine[3][4]=1.;
    rdcutsvalmine[4][4]=1.;
    rdcutsvalmine[5][4]=0.042;
    rdcutsvalmine[6][4]=0.056;
    rdcutsvalmine[7][4]=-0.000065;
    rdcutsvalmine[8][4]=0.9;
    rdcutsvalmine[9][4]=0.3;
    rdcutsvalmine[10][4]=0.1;
    rdcutsvalmine[11][4]=0.05;
    rdcutsvalmine[12][4]=100.;
    rdcutsvalmine[13][4]=0.5;
    rdcutsvalmine[14][4]=-1.;
    rdcutsvalmine[15][4]=0.;
    //4-5
    rdcutsvalmine[0][5]=0.7;
    rdcutsvalmine[1][5]=0.08;
    rdcutsvalmine[2][5]=0.9;
    rdcutsvalmine[3][5]=1.2;
    rdcutsvalmine[4][5]=1.2;
    rdcutsvalmine[5][5]=0.07;
    rdcutsvalmine[6][5]=0.07;
    rdcutsvalmine[7][5]=0.0001;
    rdcutsvalmine[8][5]=0.9;
    rdcutsvalmine[9][5]=0.3;
    rdcutsvalmine[10][5]=0.1;
    rdcutsvalmine[11][5]=0.05;
    rdcutsvalmine[12][5]=100.;
    rdcutsvalmine[13][5]=0.5;
    rdcutsvalmine[14][5]=-1.;
    rdcutsvalmine[15][5]=0.;
    //5-6
    rdcutsvalmine[0][6]=0.7;
    rdcutsvalmine[1][6]=0.1;
    rdcutsvalmine[2][6]=1.0;
    rdcutsvalmine[3][6]=1.;
    rdcutsvalmine[4][6]=1.;
    rdcutsvalmine[5][6]=0.08;
    rdcutsvalmine[6][6]=0.08;
    rdcutsvalmine[7][6]=0.0005;
    rdcutsvalmine[8][6]=0.8;
    rdcutsvalmine[9][6]=0.3;
    rdcutsvalmine[10][6]=0.1;
    rdcutsvalmine[11][6]=0.05;
    rdcutsvalmine[12][6]=100000.;
    rdcutsvalmine[13][6]=0.5;
    rdcutsvalmine[14][6]=-1.;
    rdcutsvalmine[15][6]=0.;
    //6-7
    rdcutsvalmine[0][7]=0.7;
    rdcutsvalmine[1][7]=0.1;
    rdcutsvalmine[2][7]=1.0;
    rdcutsvalmine[3][7]=1.;
    rdcutsvalmine[4][7]=1.;
    rdcutsvalmine[5][7]=0.1;
    rdcutsvalmine[6][7]=0.1;
    rdcutsvalmine[7][7]=0.001;
    rdcutsvalmine[8][7]=0.7;
    rdcutsvalmine[9][7]=0.3;
    rdcutsvalmine[10][7]=0.1;
    rdcutsvalmine[11][7]=0.05;
    rdcutsvalmine[12][7]=100.;
    rdcutsvalmine[13][7]=0.5;
    rdcutsvalmine[14][7]=-1.;
    rdcutsvalmine[15][7]=0.;
    //7-8
    rdcutsvalmine[0][8]=0.7;
    rdcutsvalmine[1][8]=0.1;
    rdcutsvalmine[2][8]=1.0;
    rdcutsvalmine[3][8]=1.;
    rdcutsvalmine[4][8]=1.;
    rdcutsvalmine[5][8]=0.1;
    rdcutsvalmine[6][8]=0.1;
    rdcutsvalmine[7][8]=0.001;
    rdcutsvalmine[8][8]=0.7;
    rdcutsvalmine[9][8]=0.3;
    rdcutsvalmine[10][8]=0.1;
    rdcutsvalmine[11][8]=0.05;
    rdcutsvalmine[12][8]=100.;
    rdcutsvalmine[13][8]=0.5;
    rdcutsvalmine[14][8]=-1.;
    rdcutsvalmine[15][8]=0.;
    //8-12
    rdcutsvalmine[0][9]=0.7;
    rdcutsvalmine[1][9]=0.1;
    rdcutsvalmine[2][9]=1.0;
    rdcutsvalmine[3][9]=1.;
    rdcutsvalmine[4][9]=1.;
    rdcutsvalmine[5][9]=0.1;
    rdcutsvalmine[6][9]=0.1;
    rdcutsvalmine[7][9]=0.006;
    rdcutsvalmine[8][9]=0.7;
    rdcutsvalmine[9][9]=0.3;
    rdcutsvalmine[10][9]=0.1;
    rdcutsvalmine[11][9]=0.05;
    rdcutsvalmine[12][9]=100.;
    rdcutsvalmine[13][9]=0.5;
    rdcutsvalmine[14][9]=-1.;
    rdcutsvalmine[15][9]=0.;
    //12-16
    rdcutsvalmine[0][10]=0.7;
    rdcutsvalmine[1][10]=0.1;
    rdcutsvalmine[2][10]=1.0;
    rdcutsvalmine[3][10]=0.3;
    rdcutsvalmine[4][10]=0.3;
    rdcutsvalmine[5][10]=0.15;
    rdcutsvalmine[6][10]=0.15;
    rdcutsvalmine[7][10]=0.01;
    rdcutsvalmine[8][10]=0.7;
    rdcutsvalmine[9][10]=0.3;
    rdcutsvalmine[10][10]=0.1;
    rdcutsvalmine[11][10]=0.05;
    rdcutsvalmine[12][10]=100.;
    rdcutsvalmine[13][10]=0.5;
    rdcutsvalmine[14][10]=-1.;
    rdcutsvalmine[15][10]=0.;
    //16-24
    rdcutsvalmine[0][11]=0.7;
    rdcutsvalmine[1][11]=0.2;
    rdcutsvalmine[2][11]=1.0;
    rdcutsvalmine[3][11]=.3;
    rdcutsvalmine[4][11]=.3;
    rdcutsvalmine[5][11]=0.15;
    rdcutsvalmine[6][11]=0.15;
    rdcutsvalmine[7][11]=0.01;
    rdcutsvalmine[8][11]=0.7;
    rdcutsvalmine[9][11]=0.3;
    rdcutsvalmine[10][11]=0.1;
    rdcutsvalmine[11][11]=0.05;
    rdcutsvalmine[12][11]=100.;
    rdcutsvalmine[13][11]=0.5;
    rdcutsvalmine[14][11]=-1.;
    rdcutsvalmine[15][11]=0.;
    //>24
    rdcutsvalmine[0][12]=0.7;
    rdcutsvalmine[1][12]=0.6;
    rdcutsvalmine[2][12]=1.0;
    rdcutsvalmine[3][12]=.4;
    rdcutsvalmine[4][12]=.4;
    rdcutsvalmine[5][12]=0.5;
    rdcutsvalmine[6][12]=0.5;
    rdcutsvalmine[7][12]=0.1;
    rdcutsvalmine[8][12]=0.7;
    rdcutsvalmine[9][12]=0.3;
    rdcutsvalmine[10][12]=0.1;
    rdcutsvalmine[11][12]=0.05;
    rdcutsvalmine[12][12]=100.;
    rdcutsvalmine[13][12]=0.5;
    rdcutsvalmine[14][12]=-1.;
    rdcutsvalmine[15][12]=0.;
  }
  else if(std::strncmp(set_cuts,"heidelberg",20) == 0){

    //0-0.5
    rdcutsvalmine[0][0]=0.7;
    rdcutsvalmine[1][0]=0.03;
    rdcutsvalmine[2][0]=0.7;
    rdcutsvalmine[3][0]=0.8;
    rdcutsvalmine[4][0]=0.8;
    rdcutsvalmine[5][0]=0.1;
    rdcutsvalmine[6][0]=0.1;
    rdcutsvalmine[7][0]=-0.00002;
    rdcutsvalmine[8][0]=0.9;
    rdcutsvalmine[9][0]=0.3;
    rdcutsvalmine[10][0]=0.1;
    rdcutsvalmine[11][0]=0.05;
    rdcutsvalmine[12][0]=100.;
    rdcutsvalmine[13][0]=0.5;
    rdcutsvalmine[14][0]=-1.;
    rdcutsvalmine[15][0]=0.;
    //0.5-1
    rdcutsvalmine[0][1]=0.7;
    rdcutsvalmine[1][1]=0.03;
    rdcutsvalmine[2][1]=0.7;
    rdcutsvalmine[3][1]=0.8;
    rdcutsvalmine[4][1]=0.8;
    rdcutsvalmine[5][1]=0.1;
    rdcutsvalmine[6][1]=0.1;
    rdcutsvalmine[7][1]=-0.00002;
    rdcutsvalmine[8][1]=0.9;
    rdcutsvalmine[9][1]=0.3;
    rdcutsvalmine[10][1]=0.1;
    rdcutsvalmine[11][1]=0.05;
    rdcutsvalmine[12][1]=100.;
    rdcutsvalmine[13][1]=0.5;
    rdcutsvalmine[14][1]=-1.;
    rdcutsvalmine[15][1]=0.;

    //1-2
    rdcutsvalmine[0][2]=0.7;
    rdcutsvalmine[1][2]=0.03;
    rdcutsvalmine[2][2]=0.7;
    rdcutsvalmine[3][2]=0.8;
    rdcutsvalmine[4][2]=0.8;
    rdcutsvalmine[5][2]=0.1;
    rdcutsvalmine[6][2]=0.1;
    rdcutsvalmine[7][2]=-0.00002;
    rdcutsvalmine[8][2]=0.9;
    rdcutsvalmine[9][2]=0.3;
    rdcutsvalmine[10][2]=0.1;
    rdcutsvalmine[11][2]=0.05;
    rdcutsvalmine[12][2]=100.;
    rdcutsvalmine[13][2]=0.5;
    rdcutsvalmine[14][2]=-1.;
    rdcutsvalmine[15][2]=0.;
    //2-3
    rdcutsvalmine[0][3]=0.7;
    rdcutsvalmine[1][3]=0.03;
    rdcutsvalmine[2][3]=0.7;
    rdcutsvalmine[3][3]=0.8;
    rdcutsvalmine[4][3]=0.8;
    rdcutsvalmine[5][3]=0.1;
    rdcutsvalmine[6][3]=0.1;
    rdcutsvalmine[7][3]=-0.00002;
    rdcutsvalmine[8][3]=0.9;
    rdcutsvalmine[9][3]=0.3;
    rdcutsvalmine[10][3]=0.1;
    rdcutsvalmine[11][3]=0.05;
    rdcutsvalmine[12][3]=100.;
    rdcutsvalmine[13][3]=0.5;
    rdcutsvalmine[14][3]=-1.;
    rdcutsvalmine[15][3]=0.;
    //3-4
    rdcutsvalmine[0][4]=0.7;
    rdcutsvalmine[1][4]=0.03;
    rdcutsvalmine[2][4]=0.7;
    rdcutsvalmine[3][4]=0.9;
    rdcutsvalmine[4][4]=0.9;
    rdcutsvalmine[5][4]=0.1;
    rdcutsvalmine[6][4]=0.1;
    rdcutsvalmine[7][4]=0.000002;
    rdcutsvalmine[8][4]=0.8;
    rdcutsvalmine[9][4]=0.3;
    rdcutsvalmine[10][4]=0.1;
    rdcutsvalmine[11][4]=0.05;
    rdcutsvalmine[12][4]=100.;
    rdcutsvalmine[13][4]=0.5;
    rdcutsvalmine[14][4]=-1.;
    rdcutsvalmine[15][4]=0.;
    //4-5
    rdcutsvalmine[0][5]=0.7;
    rdcutsvalmine[1][5]=0.03;
    rdcutsvalmine[2][5]=0.7;
    rdcutsvalmine[3][5]=0.9;
    rdcutsvalmine[4][5]=0.9;
    rdcutsvalmine[5][5]=0.1;
    rdcutsvalmine[6][5]=0.1;
    rdcutsvalmine[7][5]=0.000002;
    rdcutsvalmine[8][5]=0.8;
    rdcutsvalmine[9][5]=0.3;
    rdcutsvalmine[10][5]=0.1;
    rdcutsvalmine[11][5]=0.05;
    rdcutsvalmine[12][5]=100.;
    rdcutsvalmine[13][5]=0.5;
    rdcutsvalmine[14][5]=-1.;
    rdcutsvalmine[15][5]=0.;
    //5-6
    rdcutsvalmine[0][6]=0.7;
    rdcutsvalmine[1][6]=0.03;
    rdcutsvalmine[2][6]=0.7;
    rdcutsvalmine[3][6]=1.0;
    rdcutsvalmine[4][6]=1.0;
    rdcutsvalmine[5][6]=0.1;
    rdcutsvalmine[6][6]=0.1;
    rdcutsvalmine[7][6]=0.000002;
    rdcutsvalmine[8][6]=0.8;
    rdcutsvalmine[9][6]=0.3;
    rdcutsvalmine[10][6]=0.1;
    rdcutsvalmine[11][6]=0.05;
    rdcutsvalmine[12][6]=100.;
    rdcutsvalmine[13][6]=0.5;
    rdcutsvalmine[14][6]=-1.;
    rdcutsvalmine[15][6]=0.;
    //6-8
    rdcutsvalmine[0][7]=0.7;
    rdcutsvalmine[1][7]=0.03;
    rdcutsvalmine[2][7]=0.7;
    rdcutsvalmine[3][7]=1.0;
    rdcutsvalmine[4][7]=1.0;
    rdcutsvalmine[5][7]=0.1;
    rdcutsvalmine[6][7]=0.1;
    rdcutsvalmine[7][7]=0.000002;
    rdcutsvalmine[8][7]=0.8;
    rdcutsvalmine[9][7]=0.3;
    rdcutsvalmine[10][7]=0.1;
    rdcutsvalmine[11][7]=0.05;
    rdcutsvalmine[12][7]=100.;
    rdcutsvalmine[13][7]=0.5;
    rdcutsvalmine[14][7]=-1.;
    rdcutsvalmine[15][7]=0.;
    //8-12
    rdcutsvalmine[0][8]=0.7;
    rdcutsvalmine[1][8]=0.03;
    rdcutsvalmine[2][8]=0.7;
    rdcutsvalmine[3][8]=1.0;
    rdcutsvalmine[4][8]=1.0;
    rdcutsvalmine[5][8]=0.1;
    rdcutsvalmine[6][8]=0.1;
    rdcutsvalmine[7][8]=0.000002;
    rdcutsvalmine[8][8]=0.8;
    rdcutsvalmine[9][8]=0.3;
    rdcutsvalmine[10][8]=0.1;
    rdcutsvalmine[11][8]=0.05;
    rdcutsvalmine[12][8]=100.;
    rdcutsvalmine[13][8]=0.5;
    rdcutsvalmine[14][8]=-1.;
    rdcutsvalmine[15][8]=0.;
    //12-16
    rdcutsvalmine[0][9]=0.7;
    rdcutsvalmine[1][9]=0.03;
    rdcutsvalmine[2][9]=0.7;
    rdcutsvalmine[3][9]=1.0;
    rdcutsvalmine[4][9]=1.0;
    rdcutsvalmine[5][9]=0.1;
    rdcutsvalmine[6][9]=0.1;
    rdcutsvalmine[7][9]=0.000002;
    rdcutsvalmine[8][9]=0.8;
    rdcutsvalmine[9][9]=0.3;
    rdcutsvalmine[10][9]=0.1;
    rdcutsvalmine[11][9]=0.05;
    rdcutsvalmine[12][9]=100.;
    rdcutsvalmine[13][9]=0.5;
    rdcutsvalmine[14][9]=-1.;
    rdcutsvalmine[15][9]=0.;
    //16-20
    rdcutsvalmine[0][10]=0.7;
    rdcutsvalmine[1][10]=0.03;
    rdcutsvalmine[2][10]=0.7;
    rdcutsvalmine[3][10]=1.0;
    rdcutsvalmine[4][10]=1.0;
    rdcutsvalmine[5][10]=0.1;
    rdcutsvalmine[6][10]=0.1;
    rdcutsvalmine[7][10]=0.000002;
    rdcutsvalmine[8][10]=0.8;
    rdcutsvalmine[9][10]=0.3;
    rdcutsvalmine[10][10]=0.1;
    rdcutsvalmine[11][10]=0.05;
    rdcutsvalmine[12][10]=100.;
    rdcutsvalmine[13][10]=0.5;
    rdcutsvalmine[14][10]=-1.;
    rdcutsvalmine[15][10]=0.;
    //20-24
    rdcutsvalmine[0][11]=0.7;
    rdcutsvalmine[1][11]=0.03;
    rdcutsvalmine[2][11]=0.7;
    rdcutsvalmine[3][11]=1.0;
    rdcutsvalmine[4][11]=1.0;
    rdcutsvalmine[5][11]=0.1;
    rdcutsvalmine[6][11]=0.1;
    rdcutsvalmine[7][11]=0.000002;
    rdcutsvalmine[8][11]=0.8;
    rdcutsvalmine[9][11]=0.3;
    rdcutsvalmine[10][11]=0.1;
    rdcutsvalmine[11][11]=0.05;
    rdcutsvalmine[12][11]=100.;
    rdcutsvalmine[13][11]=0.5;
    rdcutsvalmine[14][11]=-1.;
    rdcutsvalmine[15][11]=0.;
    //>24
    rdcutsvalmine[0][12]=0.7;
    rdcutsvalmine[1][12]=0.03;
    rdcutsvalmine[2][12]=0.7;
    rdcutsvalmine[3][12]=1.0;
    rdcutsvalmine[4][12]=1.0;
    rdcutsvalmine[5][12]=0.1;
    rdcutsvalmine[6][12]=0.1;
    rdcutsvalmine[7][12]=0.000002;
    rdcutsvalmine[8][12]=0.8;
    rdcutsvalmine[9][12]=0.3;
    rdcutsvalmine[10][12]=0.1;
    rdcutsvalmine[11][12]=0.05;
    rdcutsvalmine[12][12]=100.;
    rdcutsvalmine[13][12]=0.5;
    rdcutsvalmine[14][12]=-1.;
    rdcutsvalmine[15][12]=0.;
  } else {cout << "no valid cut setting! returning...\n"; return;}
  
  RDHFDStartoKpipi->SetCuts(nvars,nptbins,rdcutsvalmine);

  Bool_t pidflag=kTRUE;
  RDHFDStartoKpipi->SetUsePID(pidflag);
  if(pidflag) cout<<"PID is used"<<endl;
  else cout<<"PID is not used"<<endl;

  // PID SETTINGS
  AliAODPidHF* pidObj=new AliAODPidHF();
  // pidObj->SetName("pid4DSatr");
  Int_t mode=1;
  Double_t priors[5]={0.01,0.001,0.3,0.3,0.3};
  pidObj->SetPriors(priors,5);
  pidObj->SetMatch(mode);
  pidObj->SetSigma(0,2); // TPC
  pidObj->SetSigma(3,3); // TOF
  pidObj->SetTPC(kTRUE);
  pidObj->SetTOF(kTRUE);
  RDHFDStartoKpipi->SetPidHF(pidObj);

  //activate pileup rejection
  RDHFDStartoKpipi->SetOptPileup(AliRDHFCuts::kRejectPileupEvent);
  //activate Trigger Mask 
  RDHFDStartoKpipi->SetTriggerMask(AliVEvent::kINT7);
  
  RDHFDStartoKpipi->SetTriggerClass("");


  RDHFDStartoKpipi->PrintAll();

  TFile* fout=new TFile("DStartoKpipiCuts_stringfix.root","recreate");   //set this!! 
  fout->cd();
  RDHFDStartoKpipi->Write();
  fout->Close();

}

